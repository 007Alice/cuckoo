<!--
  Cuckoo Sandbox - Automated Malware Analysis
  Copyright (C) 2010-2016 Cuckoo Foundation.
  http://www.cuckoosandbox.org

  This file is part of Cuckoo.

  Cuckoo is free software: you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.

  Cuckoo is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.

  You should have received a copy of the GNU General Public License
  along with this program.  If not, see http://www.gnu.org/licenses/
-->

<html>
	<head>
		{{ head }}

        <style>
            div.img-cuckoo{
                width: 186px;
                height: 60px;
            }
        </style>
	</head>

	<body>

		<!-- wrapping container, defines the wrapping width of the content -->
		<div class="container">

			<!-- top header, logo and datetime of the report -->
			<header class="main-header">
				<div class="brand">
                    <div class="img-cuckoo"></div>
				</div>
				<h1>Analysis report</h1>
				<div class="main-header-right">
					<time datetime="{{ constants["date_now"].strftime("%Y-%m-%d, %H:%M") }}">
                        <i class="fa fa-clock-o"></i> {{ constants["date_now"].strftime("%Y/%m/%d %H:%M") }}
                    </time>
				</div>
			</header>

			<!-- row -->
			<div class="row">

				<!-- block: summary -->
				<div class="block block-summary">

					<header class="block-header">
						<h4><i class="fa fa-file-o"></i> Summary - <em>{{results.target.file.name}}</em></h4>
					</header>

					<section class="block-section">

						<!-- file info -->
						<div class="block-section-col">
							<h5>File info</h5>
							<ul class="list-reset key-value-list">
								<li><strong>name: </strong> {{results.target.file.name}}</li>
								<li><strong>type: </strong> {{results.target.file.type}}</li>
								<li><strong>size: </strong> {{results.target.file.size}} bytes</li>
							</ul>
						</div>

						<!-- checksum hashes -->
						<div class="block-section-col">
							<h5>Checksums</h5>
							<ul class="list-reset list-checksums">
								<li><span class="label">SHA1</span> {{results.target.file.sha1}}</li>
								<li><span class="label">MD5</span> {{results.target.file.md5}}</li>
							</ul>
						</div>

					</section>

					<!-- <footer class="block-footer"></footer> -->

				</div>

				<!-- block: status and process messages / information -->
				<div class="block">

					<header class="block-header">
						<h4><i class="fa fa-qrcode"></i> Detected signatures</h4>
					</header>

					<section class="block-section no-padding">
						<ul class="list-reset list-status">
							<!-- <li><p>Some non-status signature</p></li> -->

                            {% if signatures %}
                                {% for severity, _signatures in signatures.iteritems() %}
                                    {% if severity == 1 %}
                                        {% set label = "info" %}
                                    {% elif severity == 2 %}
                                        {% set label = "warning" %}
                                    {% elif severity == 3 %}
                                        {% set label = "danger" %}
                                    {% else %}
                                        {% set label = "info" %}
                                    {% endif %}

                                    <li class="list-status-separator {{ label }}">{{ label.capitalize() }} messages</li>

                                    {% for signature in _signatures %}
                                        <li class="{{ label }}">
                                            {% if signature.markcount > 1 %}
                                                {% set event = "events" %}
                                            {% else %}
                                                {% set event = "event" %}
                                            {% endif %}
                                            <p>{{ signature.description }} <small>{{ signature.markcount }} {{ event }}</small></p>

                                            {% if signature.name == "antivirus_virustotal" %}
                                                {% include "sections/signatures/antivirus_virustotal.html" %}
                                            {% elif signature.name == "persistence_autorun" %}
                                                {% include "sections/signatures/persistence_autorun.html" %}
                                            {% elif signature.name == "creates_doc" %}
                                                {% include "sections/signatures/creates_doc.html" %}
                                            {% elif signature.name == "suspicious_process" %}
                                                {% include "sections/signatures/suspicious_process.html" %}
                                            {% endif %}
                                        </li>
                                    {% endfor %}
                                {% endfor %}
                            {% else %}
                                <li class="list-status-separator info">No signatures</li>
                            {% endif %}
						</ul>
					</section>

				</div>

                {% if screenshots %}
                    <!-- screenshots -->
                    <style>
                        {% for shot in screenshots %}
                            {{ shot.css }}
                        {% endfor %}
                    </style>

                    <div class="block">

                        <header class="block-header">
                            <h4><i class="fa fa-desktop"></i> Screenshots <small>({{ screenshots|length }}/{{ results.screenshots|length }})</small></h4>
                        </header>

                        <section class="block-section screenshots">
                        {% for shot in screenshots %}
                            <div class="image">
                                <div class="img-{{ shot.selector }}" id="img-shot-{{ shot.id }}"></div>
                                <p>{{ shot.name }}.jpg</p>
                            </div>
                        {% endfor %}
                        </section>

                    </div>
                {% endif %}

				<!-- processes summary -->
				<div class="block block-processes">

					<header class="block-header">
						<h4><i class="fa fa-cogs"></i> Processes <small>(warning: truncated results)</small></h4>
					</header>

                    {% for behavior, procs in behavioral.iteritems() %}
                        <section class="block-section no-padding process-view">
                            <header class="process-view-header">
                                <h5>{{ loop.index + 1 }}. {{ behavior.capitalize() }}</h5>
                            </header>
                            {% for proc_name, proc in procs.iteritems() %}
                                <ul class="process-display list-reset">
                                    <li class="process-display-title">{{ proc.process_name }} <span class="pid">pid: {{ proc.pid }}</span></li>
                                    {% for event_type, events in proc.events.iteritems() %}
                                    <li>
                                        {{ event_type }}:
                                        <ul>
                                            {% for event in events[0:15] %}
                                                <li>{{ event }}</li>
                                            {% endfor %}
                                        </ul>
                                    </li>
                                    {% endfor %}
                                </ul>
                            {% endfor %}
                        </section>
                    {% endfor %}
				</div>

				<!-- process memory dump -->
				<div class="block block-procmemory">

					<header class="block-header">
						<h4><i class="fa fa-barcode"></i> Process memory dump</h4>
					</header>

					<ul class="list-reset list-simple">
						<li class="list-simple-title">URLs found in process memory</li>
						<li class="monospace">http://schemas.microsoft.com/xps/2005/06</li>
						<li class="monospace malicious"><i class="fa fa-warning"></i> http://www.gewgle.org/</li>
						<li class="monospace malicious"><i class="fa fa-warning"></i> https://www.facebo.ok/</li>
						<li class="monospace malicious"><i class="fa fa-warning"></i> http://www.myfirstadware.net/get/worst-version</li>
					</ul>

				</div>

				<!-- network -->
				<div class="block block-network">

					<header class="block-header">
						<h4><i class="fa fa-globe"></i> Network</h4>
					</header>

					<section class="block-section no-padding process-view">

						<header class="process-view-header">
							<h5>DNS (3)</h5>
						</header>

						<!-- table with info -->
						<table>
							<thead>
								<tr>
									<th>Name</th>
									<th>Response</th>
									<th>Post-analysis lookup</th>
								</tr>
							</thead>
							<tbody>
								<tr>
									<td>www.msftncsi.com</td>
									<td></td>
									<td>82.94.234.89</td>
								</tr>
								<tr>
									<td>dns.msftncsi.com</td>
									<td></td>
									<td>131.107.255.255</td>
								</tr>
								<tr>
									<td>teredo.ipv6.microsoft.com</td>
									<td></td>
									<td></td>
								</tr>
							</tbody>
						</table>

					</section>

					<section class="block-section no-padding process-view">

						<header class="process-view-header">
							<h5>Hosts (1)</h5>
						</header>

						<table>
							<thead>
								<tr>
									<th>IP Address</th>
								</tr>
							</thead>
							<tbody>
								<tr>
									<td>8.8.8.8</td>
								</tr>
							</tbody>
						</table>

					</section>

				</div>

				<!-- behavioral data -->
				<div class="block block-behavioral">

					<header class="block-header">
						<h4><i class="fa fa-heartbeat"></i> Behavioral</h4>
					</header>

					<section class="block-section no-padding process-view">

						<header class="process-view-header clearfix">
							<h5><span class="indicate"></span> default</h5>
							<small class="pull-right limited-results"><i class="fa fa-info"></i> data limited to 3 records</small>
						</header>

						<table>
							<thead>
								<tr>
									<th>Time &amp; API</th>
									<th>Arguments</th>
									<th>Status</th>
									<th class="small-integer">Return</th>
									<th class="small-integer">Repeated</th>
								</tr>
							</thead>
							<tbody>

								<tr>
									<td>
										<time datetime="July 20, 2016, 8:49 a.m.">July 20, 2016, 8:42 a.m.</time>
										<p class="monospace">GetSystemTimeAsFileTime</p>
									</td>
									<td></td>
									<td><span class="monospace">success</span></td>
									<td><span class="monospace">0</span></td>
									<td><span class="monospace">0</span></td>
								</tr>

								<tr>
									<td>
										<time datetime="July 20, 2016, 8:49 a.m.">July 20, 2016, 8:42 a.m.</time>
										<p class="monospace">NtProtectVirtualMemory</p>
									</td>
									<td>
										<ul class="list-reset list-arguments">
											<li>base_address: 0x00949000</li>
											<li>length: 4096</li>
											<li>protection: 64 (PAGE_EXECUTE_READWRITE)</li>
											<li>process_identifier: 2128</li>
											<li>process_handle: 0xffffffff</li>
										</ul>
									</td>
									<td><span class="monospace">success</span></td>
									<td><span class="monospace">0</span></td>
									<td><span class="monospace">0</span></td>
								</tr>

								<tr>
									<td>
										<time datetime="July 20, 2016, 8:49 a.m.">July 20, 2016, 8:49 a.m.</time>
										<p class="monospace">SetUnhandledExceptionFilter</p>
									</td>
									<td></td>
									<td><span class="monospace failed">failed</span></td>
									<td><span class="monospace">0</span></td>
									<td><span class="monospace">0</span></td>
								</tr>

							</tbody>
						</table>

					</section>

					<section class="block-section no-padding process-view">

						<header class="process-view-header">
							<h5><span class="indicate indicate-registry"></span> registry</h5>
						</header>

					</section>

					<section class="block-section no-padding process-view">

						<header class="process-view-header">
							<h5><span class="indicate indicate-file"></span> file</h5>
						</header>

					</section>

					<section class="block-section no-padding process-view">

						<header class="process-view-header">
							<h5><span class="indicate indicate-network"></span> network</h5>
						</header>

					</section>

					<section class="block-section no-padding process-view">

						<header class="process-view-header">
							<h5><span class="indicate indicate-process"></span> process</h5>
						</header>

					</section>

					<section class="block-section no-padding process-view">

						<header class="process-view-header">
							<h5><span class="indicate indicate-services"></span> services</h5>
						</header>

					</section>

					<section class="block-section no-padding process-view">

						<header class="process-view-header">
							<h5><span class="indicate indicate-synchronisation"></span> synchronisation</h5>
						</header>

					</section>

					<section class="block-section no-padding process-view">

						<header class="process-view-header">
							<h5><span class="indicate indicate-iexplore"></span> iexplore</h5>
						</header>

					</section>

					<section class="block-section no-padding process-view">

						<header class="process-view-header">
							<h5><span class="indicate indicate-office"></span> office</h5>
						</header>

					</section>

					<section class="block-section no-padding process-view">

						<header class="process-view-header">
							<h5><span class="indicate indicate-pdf"></span> pdf</h5>
						</header>

					</section>

				</div>

			</div>

			<footer class="footnote">
				&copy; 2010 - 2016, Cuckoo Sandbox
			</footer>

		</div>

	</body>

</html>