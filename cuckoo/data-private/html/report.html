<!--
  Cuckoo Sandbox - Automated Malware Analysis
  Copyright (C) 2010-2015 Cuckoo Foundation.
  http://www.cuckoosandbox.org

  This file is part of Cuckoo.

  Cuckoo is free software: you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.

  Cuckoo is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.

  You should have received a copy of the GNU General Public License
  along with this program.  If not, see http://www.gnu.org/licenses/
-->

<html>
	<head>
		{{ head }}
	</head>

	<body>

		<!-- wrapping container, defines the wrapping width of the content -->
		<div class="container">

			<!-- top header, logo and datetime of the report -->
			<header class="main-header">
				<div class="brand">
					<img src="static/img/cuckoo.png" alt="Cuckoo" />
				</div>
				<h1>Analysis report</h1>
				<div class="main-header-right">
					<time datetime="11-03-2016, 16:48"><i class="fa fa-clock-o"></i> {{ constants["date_now"] }} </time>
				</div>
			</header>

			<!-- row -->
			<div class="row">

				<!-- block: summary -->
				<div class="block block-summary">

					<header class="block-header">
						<h4><i class="fa fa-file-o"></i> Summary - <em>{{results.target.file.name}}</em></h4>
					</header>

					<section class="block-section">

						<!-- file info -->
						<div class="block-section-col">
							<h5>File info</h5>
							<ul class="list-reset key-value-list">
								<li><strong>name: </strong> {{results.target.file.name}}</li>
								<li><strong>type: </strong> {{results.target.file.type}}</li>
								<li><strong>size: </strong> {{results.target.file.size}} bytes</li>
							</ul>
						</div>

						<!-- checksum hashes -->
						<div class="block-section-col">
							<h5>Checksums</h5>
							<ul class="list-reset list-checksums">
								<li><span class="label">SHA1</span> {{results.target.file.sha1}}</li>
								<li><span class="label">MD5</span> {{results.target.file.md5}}</li>
							</ul>
						</div>

					</section>

					<!-- <footer class="block-footer"></footer> -->

				</div>

				<!-- block: status and process messages / information -->
				<div class="block">

					<header class="block-header">
						<h4><i class="fa fa-qrcode"></i> Detected signatures</h4>
					</header>

					<section class="block-section no-padding">
						<ul class="list-reset list-status">
							<!-- <li><p>Some non-status signature</p></li> -->

                            {% if signatures %}
                                {% for severity, _signatures in signatures.iteritems() %}
                                    {% if severity == 1 %}
                                        {% set label = "info" %}
                                    {% elif severity == 2 %}
                                        {% set label = "warning" %}
                                    {% elif severity == 3 %}
                                        {% set label = "danger" %}
                                    {% else %}
                                        {% set label = "info" %}
                                    {% endif %}

                                    <li class="list-status-separator {{ label }}">{{ label.capitalize() }} messages</li>

                                    {% for signature in _signatures %}
                                        <li class="{{ label }}">
                                            {% if signature.markcount > 1 %}
                                                {% set event = "events" %}
                                            {% else %}
                                                {% set event = "event" %}
                                            {% endif %}
                                            <p>{{ signature.description }} <small>{{ signature.markcount }} {{ event }}</small></p>

                                            {% if signature.name == "antivirus_virustotal" %}
                                                {% set display_max = 6 %}
                                                <table class="table-key-value">
                                                    <tbody>
                                                    {% for viri in signature.marks %}
                                                        {% if viri.ioc and loop.index <= display_max %}
                                                            <tr>
                                                                <td><span class="monospace">{{ viri.category }}</span></td>
                                                                <td><span class="monospace malicious">{{ viri.ioc }}</span></td>
                                                            </tr>

                                                            {% if loop.index == display_max %}
                                                                <tr>
                                                                    <td><span class="monospace">And more ...</span></td>
                                                                    <td><span class="monospace malicious"></span></td>
                                                                </tr>
                                                            {% endif %}
                                                        {% endif %}
                                                    {% endfor %}
                                                    </tbody>
                                                </table>
                                            {% elif signature.name == "persistence_autorun" %}
                                                <table class="table-key-value">
                                                    <tbody>
                                                    {% for regkey in signature.marks %}
                                                        <tr>
                                                            <td><span class="monospace">{{ regkey.category.capitalize() }}</span></td>
                                                            <td><span class="monospace">{{ regkey.ioc }}</span></td>
                                                        </tr>
                                                    {% endfor %}
                                                    </tbody>
                                                </table>
                                            {% elif signature.name == "creates_doc" %}
                                                <table class="table-key-value">
                                                    <tbody>
                                                    {% for doc in signature.marks %}
                                                        <tr>
                                                            <td><span class="monospace">{{ doc.category.capitalize() }}</span></td>
                                                            <td><span class="monospace">{{ doc.ioc }}</span></td>
                                                        </tr>
                                                    {% endfor %}
                                                    </tbody>
                                                </table>
                                            {% elif signature.name == "suspicious_process" %}
                                                <table class="table-key-value">
                                                    <tbody>
                                                    {% for proc in signature.marks %}
                                                        <tr>
                                                            <td><span class="monospace">{{ proc.category }}</span></td>
                                                            <td><span class="monospace">{{ proc.ioc }}</span></td>
                                                        </tr>
                                                    {% endfor %}
                                                    </tbody>
                                                </table>
                                            {% endif %}

                                        </li>
                                    {% endfor %}
                                {% endfor %}
                            {% else %}
                                test
                                <li class="list-status-separator info">No signatures</li>
                            {% endif %}
						</ul>
					</section>

				</div>

				<!-- screenshots -->
				<div class="block">

					<header class="block-header">
						<h4><i class="fa fa-desktop"></i> Screenshots</h4>
					</header>

					<section class="block-section screenshots">
						<div class="image">
							<img src="img/screenshots/1.jpg" alt="1" />
							<p>1.jpg - Screenshot description</p>
						</div>
						<div class="image">
							<img src="img/screenshots/2.jpg" alt="2" />
							<p>2.jpg - Screenshot description</p>
						</div>

					</section>

				</div>

				<!-- processes summary -->
				<div class="block block-processes">

					<header class="block-header">
						<h4><i class="fa fa-cogs"></i> Processes</h4>
					</header>

					<section class="block-section no-padding process-view">
						<header class="process-view-header">
							<h5>1. Files</h5>
						</header>

						<ul class="process-display list-reset">
							<li class="process-display-title">Explorer.exe <span class="pid">pid: 1336</span></li>
							<li>
								file_read:
								<ul>
									<li>C:\Users\Administrator\AppData\Local\Microsoft\Windows\Burn\Burn\desktop.ini</li>
									<li>C:\Users\desktop.ini</li>
									<li>C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Microsoft Office 2013\Excel 2013.lnk</li>
								</ul>
							</li>
							<li>
								file_opened:
								<ul>
									<li>C:\Windows\System32\imageres.dll</li>
									<li>C:\Windows\Fonts\arial.ttf</li>
									<li>C:\</li>
									<li>C:\Users\Administrator\AppData\Local\Temp</li>
									<li>C:\Windows\Fonts\tahoma.ttf</li>
								</ul>
							</li>
						</ul>

						<ul class="process-display list-reset">
							<li class="process-display-title">EXCEL.EXE <span class="pid">pid: 2128</span></li>
							<li>
								file_read:
								<ul>
									<li>C:\Windows\System32\imageres.dll</li>
									<li>C:\Windows\Fonts\arial.ttf</li>
									<li>C:\</li>
									<li>C:\Users\Administrator\AppData\Local\Temp</li>
									<li>C:\Windows\Fonts\tahoma.ttf</li>
								</ul>
							</li>
							<li>
								file_opened:
								<ul>
									<li>C:\Users\Administrator\AppData\Local\Temp\8b8960a855603393190152439c64ac9fd16655b304d472ecb83422900369a266</li>
									<li>C:\Users\desktop.ini</li>
								</ul>
							</li>
						</ul>

					</section>

					<section class="block-section no-padding process-view">
						<header class="process-view-header">
							<h5>2. Registry</h5>
						</header>

						<ul class="process-display list-reset">
							<li class="process-display-title">EXCEL.EXE <span class="pid">pid: 2128</span></li>
							<li>
								regkey_written
								<ul>
									<li>HKEY_CURRENT_USER\Software\Microsoft\Office\15.0\Excel\Resiliency\StartupItems\.a?</li>
									<li>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UserData\S-1-5-18\Products\00005109E60090400000000000F01FEC\Usage\ProductNonBootFilesIntl_1033</li>
									<li>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UserData\S-1-5-18\Products\00005119110000000000000000F01FEC\Usage\ProductFiles</li>
									<li>HKEY_CURRENT_USER\Software\Microsoft\Office\15.0\Excel\MTTT</li>
									<li>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings\ZoneMap\UNCAsIntranet</li>
								</ul>
							</li>
							<li>
								regkey_opened
								<ul>
									<li>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Installer\UserData\S-1-5-18\Components\CFFC5E9EEFFA38F46A597743AF74579B</li>
									<li>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Installer\UserData\S-1-5-18\Components\7A1D1891699C40E459B785BF7198266C</li>
									<li>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\2</li>
									<li>HKEY_CURRENT_USER\Software\Microsoft\AuthCookies\Live\Default\CAW</li>
									<li>HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Office\15.0\User Settings\OneNoteToWordAddin</li>
								</ul>
							</li>
							<li>
								regkey_read
								<ul>
									<li>HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Office\15.0\User Settings\{2F632ABD-D62A-46C8-BF95-70186096F1ED}\Order</li>
									<li>HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Office\15.0\User Settings\{2030A84D-D6C7-4968-8CEC-CF4737ACC337}\Order</li>
									<li>HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Control\Nls\CustomLocale\nso-ZA</li>
									<li>HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Control\Nls\Locale\00000501</li>
									<li>HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Office\15.0\User Settings\{4C1D1588-3088-4796-B3B2-8935F3A0D886}\Order</li>
								</ul>
							</li>
						</ul>

					</section>

					<section class="block-section no-padding process-view">
						<header class="process-view-header">
							<h5>3. Mutexes</h5>
						</header>
					</section>

					<section class="block-section no-padding process-view">
						<header class="process-view-header">
							<h5>4. Directories</h5>
						</header>
					</section>

					<section class="block-section no-padding process-view">
						<header class="process-view-header">
							<h5>5. Processes</h5>
						</header>
					</section>

				</div>

				<!-- process memory dump -->
				<div class="block block-procmemory">

					<header class="block-header">
						<h4><i class="fa fa-barcode"></i> Process memory dump</h4>
					</header>

					<ul class="list-reset list-simple">
						<li class="list-simple-title">URLs found in process memory</li>
						<li class="monospace">http://schemas.microsoft.com/xps/2005/06</li>
						<li class="monospace malicious"><i class="fa fa-warning"></i> http://www.gewgle.org/</li>
						<li class="monospace malicious"><i class="fa fa-warning"></i> https://www.facebo.ok/</li>
						<li class="monospace malicious"><i class="fa fa-warning"></i> http://www.myfirstadware.net/get/worst-version</li>
					</ul>

				</div>

				<!-- network -->
				<div class="block block-network">

					<header class="block-header">
						<h4><i class="fa fa-globe"></i> Network</h4>
					</header>

					<section class="block-section no-padding process-view">

						<header class="process-view-header">
							<h5>DNS (3)</h5>
						</header>

						<!-- table with info -->
						<table>
							<thead>
								<tr>
									<th>Name</th>
									<th>Response</th>
									<th>Post-analysis lookup</th>
								</tr>
							</thead>
							<tbody>
								<tr>
									<td>www.msftncsi.com</td>
									<td></td>
									<td>82.94.234.89</td>
								</tr>
								<tr>
									<td>dns.msftncsi.com</td>
									<td></td>
									<td>131.107.255.255</td>
								</tr>
								<tr>
									<td>teredo.ipv6.microsoft.com</td>
									<td></td>
									<td></td>
								</tr>
							</tbody>
						</table>

					</section>

					<section class="block-section no-padding process-view">

						<header class="process-view-header">
							<h5>Hosts (1)</h5>
						</header>

						<table>
							<thead>
								<tr>
									<th>IP Address</th>
								</tr>
							</thead>
							<tbody>
								<tr>
									<td>8.8.8.8</td>
								</tr>
							</tbody>
						</table>

					</section>

				</div>

				<!-- behavioral data -->
				<div class="block block-behavioral">

					<header class="block-header">
						<h4><i class="fa fa-heartbeat"></i> Behavioral</h4>
					</header>

					<section class="block-section no-padding process-view">

						<header class="process-view-header clearfix">
							<h5><span class="indicate"></span> default</h5>
							<small class="pull-right limited-results"><i class="fa fa-info"></i> data limited to 3 records</small>
						</header>

						<table>
							<thead>
								<tr>
									<th>Time &amp; API</th>
									<th>Arguments</th>
									<th>Status</th>
									<th class="small-integer">Return</th>
									<th class="small-integer">Repeated</th>
								</tr>
							</thead>
							<tbody>

								<tr>
									<td>
										<time datetime="July 20, 2016, 8:49 a.m.">July 20, 2016, 8:42 a.m.</time>
										<p class="monospace">GetSystemTimeAsFileTime</p>
									</td>
									<td></td>
									<td><span class="monospace">success</span></td>
									<td><span class="monospace">0</span></td>
									<td><span class="monospace">0</span></td>
								</tr>

								<tr>
									<td>
										<time datetime="July 20, 2016, 8:49 a.m.">July 20, 2016, 8:42 a.m.</time>
										<p class="monospace">NtProtectVirtualMemory</p>
									</td>
									<td>
										<ul class="list-reset list-arguments">
											<li>base_address: 0x00949000</li>
											<li>length: 4096</li>
											<li>protection: 64 (PAGE_EXECUTE_READWRITE)</li>
											<li>process_identifier: 2128</li>
											<li>process_handle: 0xffffffff</li>
										</ul>
									</td>
									<td><span class="monospace">success</span></td>
									<td><span class="monospace">0</span></td>
									<td><span class="monospace">0</span></td>
								</tr>

								<tr>
									<td>
										<time datetime="July 20, 2016, 8:49 a.m.">July 20, 2016, 8:49 a.m.</time>
										<p class="monospace">SetUnhandledExceptionFilter</p>
									</td>
									<td></td>
									<td><span class="monospace failed">failed</span></td>
									<td><span class="monospace">0</span></td>
									<td><span class="monospace">0</span></td>
								</tr>

							</tbody>
						</table>

					</section>

					<section class="block-section no-padding process-view">

						<header class="process-view-header">
							<h5><span class="indicate indicate-registry"></span> registry</h5>
						</header>

					</section>

					<section class="block-section no-padding process-view">

						<header class="process-view-header">
							<h5><span class="indicate indicate-file"></span> file</h5>
						</header>

					</section>

					<section class="block-section no-padding process-view">

						<header class="process-view-header">
							<h5><span class="indicate indicate-network"></span> network</h5>
						</header>

					</section>

					<section class="block-section no-padding process-view">

						<header class="process-view-header">
							<h5><span class="indicate indicate-process"></span> process</h5>
						</header>

					</section>

					<section class="block-section no-padding process-view">

						<header class="process-view-header">
							<h5><span class="indicate indicate-services"></span> services</h5>
						</header>

					</section>

					<section class="block-section no-padding process-view">

						<header class="process-view-header">
							<h5><span class="indicate indicate-synchronisation"></span> synchronisation</h5>
						</header>

					</section>

					<section class="block-section no-padding process-view">

						<header class="process-view-header">
							<h5><span class="indicate indicate-iexplore"></span> iexplore</h5>
						</header>

					</section>

					<section class="block-section no-padding process-view">

						<header class="process-view-header">
							<h5><span class="indicate indicate-office"></span> office</h5>
						</header>

					</section>

					<section class="block-section no-padding process-view">

						<header class="process-view-header">
							<h5><span class="indicate indicate-pdf"></span> pdf</h5>
						</header>

					</section>

				</div>

			</div>

			<footer class="footnote">
				&copy; 2010 - 2016, Cuckoo Sandbox
			</footer>

		</div>

	</body>

</html>